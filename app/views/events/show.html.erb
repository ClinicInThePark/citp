<% provide(:title,"All Organizations") %>

<!--<%=@event.boothlist.map{|booth_id| Booth.find(booth_id)}%>-->
<div class="row">
	<div class="col-sm-10 col-md-10">
		<h3><%=@event.date%> <%=@event.location%></h3>
		<script type="text/javascript">
		$(function () {
			  new Highcharts.Chart({
			    chart: { renderTo: 'orders_chart', type:'column'},
			    title: { text: 'Total Attendance'},
		        xAxis: {categories: ['Attending Booths']},
		        yAxis: {
		            min: 0,
		            title: {text: 'People attended'}
		        },
		        tooltip: {
		            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
		            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
		                '<td style="padding:0"><b>{point.y} people</b></td></tr>',
		            footerFormat: '</table>',
		            shared: true,
		            useHTML: true
		        },
		        plotOptions: {
		            column: {
		                pointPadding: 0.2,
		                borderWidth: 0
		            }
		        },
		        series: [
		        	<%@event.boothlist.each do |booth_id|%>
		        	<%booth = Booth.find(booth_id)%>
		        {
		            name: '<%=booth.name%>',
		            data: [<%if booth.attendances.find_by(event_id:@event.id) != nil%> 
					    		<%=booth.attendances.find_by(event_id:@event.id).booth_attendance%>
					    	<%else%>
					    		<%=0%>
					    	<%end%>]
		        },
		        <%end%>
		        ]
			  });
			});
		</script>
		<div id="orders_chart" style="width:560px; height:300px;"></div>
	
        
<br>

<div class="panel panel-default">
    <div class="panel-heading">
        Attending Organizations
	<div class="pull-right">
        <div class="btn-group open">
            <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-expanded="true">
                Actions
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu pull-right" role="menu">
                <li><%=link_to "Print Passport", passport_path(@event)%></li>
    			<li><%=link_to "Add Attendance", attendance_path(@event)%></li>
    			<li><%=link_to "Excel", event_path(format:"xls")%></li>
            </ul>
        </div>
    </div>
</div>
        <!-- /.panel-heading -->
<div class="panel-body">
    <div class="table-responsive">
        <table class="table table-striped table-bordered table-hover">
            <thead>
                <tr>
                   	<th><b>Organizations</b></th>
					<th><b>Attendance</b></th>
					<th><b>Service Provided</b></th>
                </tr>
            </thead>
            <tbody>
			<%@event.boothlist.each do |booth_id|%>
				<%booth = Booth.find(booth_id)%>
					 <tr>	
					    <td><%=booth.name%></td>
					    <td>
					    	<%if booth.attendances.find_by(event_id:@event.id) != nil%> 
					    		<%=booth.attendances.find_by(event_id:@event.id).booth_attendance%>
					    	<%else%>
					    		<%=0%>
					    	<%end%>
					    </td>
					    <td><%=booth.description%> 
					    	<%= link_to booth, method: :delete, data: { confirm: "Are you sure about removing this booth?" }, class:"event-glyph-buttons" do%>
					 		 	<i class="glyphicon glyphicon-trash"></i>
					 		<% end %>
						    
						    <!--button for editing event-->
						    <%=link_to  edit_booth_path(booth), class:"event-glyph-buttons" do %>
							     <i class="glyphicon glyphicon-pencil"></i>
							<% end %>
					    </td>
					 </tr>
				<%end%>
			</tbody>
        </table>
    </div>
    <!-- /.table-responsive -->
</div>
<!-- /.panel-body -->
</div>
	
</div><!--col-sm-10 col-md-10-->    
</div><!--row-->
			
</hr>
